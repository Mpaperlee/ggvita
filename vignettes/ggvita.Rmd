---
title: 'ggvita: Visualization for Tree Alignment'
author: "Jianrong Philip Yang, Meng Yuan, Xiaolong Cao"
date: '2017-10-10'
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Vignette Title}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

R package, ggvita, is developed for visualization of tree alignment results. These results connect genotypes with phenotypes during a binary-tree development, from single cell ( usually zygote ) to multiple cells. Pro. Jianrong Philip Yang designed an algorithm to calculate the similarity between trees, in Sun Yat-sen University, Guang Zhou. This algorithm can dectect tree similar phenotypes at the sub tree scale. When we connect both genotypes and phenotypes of livings, we can observe some interesting phenomena and find out the biology mechanisms behind them. stat_EPIC function can add expression levels of genes from EPIC (http://epic.gs.washington.edu/) on the branches of trees alignment results.


**The results should be obtained through DELTA software FIRSTLY.**

## Local alignment 

* Read in the result from DELTA. 
```
library(ggvita)
alm_file <- "the address of ggvita data -- fun.alm "
alml_file <- "the address of ggvita data -- fun.alml "
alml_list <- readal(outfile= alml_file, fileS=alm_file, fileT=alml_file)
```
ggvita. This will only show the basic tree alignment result with structures of treeS and treeT.

```
p <- ggvita(alml_list, 3)
p
```

* stat_EPIC. This will show the tree alignment result with both genotype and phenotype of treeS and treeT.

```{r, eval=FALSE, message=TRUE, warning=FALSE, include=FALSE}

the_EPIC_expr_file <- "~/2017-2018/Predict_expr/data/epic/epic_data/CD20061215_pha4I2L_11.csv"
pp <- p+stat_EPIC(p,the_EPIC_expr_file)
pp
```
This is an example of PHA-4 gene expression.



* stat_EPIC. This will show the tree alignment result with both genotype and phenotype of treeS and treeT.

```{r, eval=FALSE, message=TRUE, warning=FALSE, include=FALSE}

ppp <- pp+geom_tippoint(p,the_EPIC_expr_file)
pp
```
This is an example of PHA-4 gene expression.






#### **Generally %+ggvita% is highly recommended than + !**

Note that ggvita has compatibility with ggtree and ggplot2 system.  However, when you need to add theme_* to ggvita object, use "%+ggvita%" instead.

```
library(ggplot2)
pp %+ggvita% theme_bw() 

```
```
pp+geom_vline(xintercept = 5,color="red")

```


```
pp %+ggvita%
  geom_vline(xintercept = 5,color="red") %+ggvita% 
  theme_dark() %+ggvita% 
  geom_hline(yintercept = 400)

```

**Have fun!**  


Contact with authors via [yuanm26@mail2.sysu.edu.cn](yuanm26@mail2.sysu.edu.cn)

